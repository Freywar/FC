<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <link href="FC.css" rel="stylesheet" />
    <script src="FC.js"></script>
    <script type="text/javascript">
        var combos = [];

        function updateCombos()
        {
            for (var i = 0; i < combos.length; i++)
            {
                combos[i].setLocalSearch(document.getElementById('localSearch').checked === 'checked');
                combos[i].setLocalSearchTimeout(+document.getElementById('localSearchTimeout').value);
                combos[i].setServerSearch(document.getElementById('serverSearch').checked === 'checked');
                combos[i].setServerSearchTimeout(+document.getElementById('serverSearchTimeout').value);
                combos[i].setShowIcons(document.getElementById('showIcons').checked === 'checked');
                combos[i].setMultiselect(document.getElementById('multiselect').checked === 'checked');
                combos[i].refresh();
            }
        }

        function addCombo()
        {
            combos.push(new Combo({
                parentNode: document.getElementById('combos'),
                emptyText: 'Search...',
                emptyListText: 'Nothing found',
                width: 400,
                height: 24,
                selectionChanged: delegate(function (s, e) { console.log(e) }, this)
            }))
        }

        function loaded()
        {
            addCombo();

            var xhr = new XMLHttpRequest();
            xhr.open('GET', '/getUsers?first_name&last_name&domain', true);
            xhr.onreadystatechange = function ()
            {
                if (xhr.readyState === 4 && xhr.status === 200)
                    document.getElementById('data').innerText = 'Available users:\n' + xhr.responseText.replace(/\{/g, '\n{');
            }
            xhr.send(null, true);
        }
    </script>
</head>

<body onload="loaded()">
    <input id="localSearch" type="checkbox" checked="checked" onchange="updateCombos()" /> Use local search after <input id="localSearchTimeout" type="text" value="100" onchange="updateCombos()" /> ms.<br />
    <input id="serverSearch" type="checkbox" onchange="updateCombos()" /> Use server search after <input type="text" value="1000" onchange="updateCombos()" /> ms.<br />
    <input id="showIcons" type="checkbox" checked="checked" /> Show photos.<br />
    <input id="multiselect" type="checkbox" onchange="updateCombos()" /> Enable multiselect.<br />
    <br />
    <div id="combos"></div><br />
    <input type="button" value="Add combo." onclick="addCombo()" /><br />
    <br />
    <div id="data"></div>


</body>
</html>
